# 第七章 数据库和AWS
**《AWS认证解决方案架构师-联合考试》中的本章节目标包括不限于如下内容：**























### 备份恢复
* Amazon RDS为跨不同数据库引擎的备份和恢复过程提供了一致的操作模型。Amazon RDS提供了两种备份数据库的机制：自动备份和手动快照。通过结合使用这两种技术，可以设计备份恢复模型来保护应用程序数据。

* 每个组织通常会根据应用程序的关键性和用户的期望，为重要应用程序定义恢复点目标（RPO）和恢复时间目标（RTO）。企业系统的RPO以分钟为单位，RTO以小时甚至几天为单位，这是很常见的，而一些关键应用程序的容忍度可能要低得多。

* RPO被定义为在发生故障或事件时可接受的数据丢失的最大周期。例如，许多系统每15分钟备份一次事务日志，以便在意外删除或硬件故障时将数据丢失降至最低。

* RTO被定义为允许从备份中恢复并恢复处理的最大停机时间。特别是对于大型数据库，从完整备份还原可能需要几个小时。如果发生硬件故障，可以通过故障转移到辅助节点将RTO减少到几分钟。您应该创建一个恢复计划，该计划至少允许您从最近的备份中恢复。

#### 自动备份
* 自动备份是Amazon RDS的一个特性，它可以持续跟踪更改并备份数据库。Amazon RDS会创建数据库实例的存储卷快照，备份整个数据库实例，而不仅仅是单个数据库。可以在创建数据库实例时设置备份保留期。默认情况下将保留一天的备份，但您可以修改保留期最多为35天。请记住，删除数据库实例时，会删除所有自动备份快照，并且无法恢复。但是，不会删除手动快照。

* 在可配置的30分钟维护窗口（称为备份窗口）中，每天都会进行自动备份。自动备份保留可配置的天数，称为备份保留期。在此保留期内，可以将数据库实例还原到任何特定时间，从而创建新的数据库实例。

#### 手工DB快照
* 除了自动备份之外，您还可以随时执行手动数据库快照。数据库快照由您启动，可以根据需要频繁创建。然后可以随时将数据库实例还原到数据库快照中的特定状态。可以使用Amazon RDS控制台或CreateDBSnapshot操作创建DB快照。与在保留期之后删除的自动快照不同，手动数据库快照将一直保留，直到使用Amazon RDS控制台或DeleteDBSnapshot操作显式删除它们。

* 备注
```
  对于繁忙的数据库，使用Multi-AZ将快照的性能影响降到最低。
  在备份窗口期间，在备份数据时，存储I/O可能会挂起，并且您可能会遇到延迟增加的情况。
  此I/O挂起通常持续快照期间。
  对于多Multi-AZ DB部署，这段I/O暂停时间更短，因为备份是从备用数据库进行的，
  但是在备份过程中可能会出现延迟
```

#### 恢复
* 无论是执行自动备份还是手动数据库快照，Amazon RDS都允许您快速恢复数据库。无法从DB快照恢复到现有的DB实例；在还原时创建新的DB实例。还原数据库实例时，只有默认的数据库参数和安全组与restoredinstance关联。一旦还原完成，您就应该将从中还原的实例使用的任何自定义数据库参数或安全组关联起来。当使用自动备份时，Amazon RDS将在预定义的维护窗口期间执行的每日备份与事务日志结合起来，使您能够将DB实例恢复到保留期内的任何点，通常恢复到最后5分钟

### 安全
* 保护Amazon RDS DB实例和关系数据库的安全需要一个全面的计划，该计划涉及数据库驱动系统中常见的许多层。这包括基础设施资源、数据库和网络。

* 使用限制AWS管理员可以执行哪些操作的AWS标识和访问管理（IAM）策略保护对基础结构资源的访问。例如，可以在IAM中控制的一些关键管理员操作包括CreateDBInstance和DeleteDBInstance。

* 另一个安全最佳实践是将Amazon RDS DB实例部署到Amazon虚拟私有云（Amazon VPC）中的私有子网中，该子网限制对DB实例的网络访问。在部署到Amazon VPC之前，必须首先创建一个DB子网组，该子网组预先定义哪些子网可用于Amazon RDS部署。此外，使用网络访问控制列表（ACL）和安全组限制网络访问，以将入站流量限制为源IP地址的短列表。

* 在数据库级别，还需要创建用户并授予他们对数据库的读写权限。对数据库的访问是通过数据库技术特别是访问控制和用户管理机制来控制的。使用频繁轮换的强密码在数据库级别创建用户。

* 最后，使用Amazon RDS提供的多种加密功能保护传输和静止数据的机密性。不同引擎的安全特性略有不同，但所有引擎都支持某种形式的传输中加密和静止加密。您可以使用安全套接字层（SSL）将客户机安全地连接到正在运行的DB实例，以保护传输中的数据。所有使用Amazon密钥管理服务（KMS）或透明数据加密（TDE）的引擎都可以使用静态加密。对于加密的Amazon RDS实例，所有日志、备份和快照都是加密的。


























