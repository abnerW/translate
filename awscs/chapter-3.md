# 第三章 Amazon Elastic Computer Cloud(Amazon EC2) 和 Amazon Elastic Block Store(Amazon EBS)
**《AWS认证解决方案架构师-联合考试》中的本章节目标包括不限于如下内容：**

## 第一点 设计高可用、低成本、容错、可扩展的系统

### 找出和识别云架构考虑因素，例如：基础组件和有效性设计

**包括如下内容：**
```
  * 怎么设计云服务
  * 计划和设计
  * 监控和日志
```

## 第二点 实现/部署

### 使用Amazon Ec2、amazon Simple Storage Service（amazon S3）、aws Elastic Beanstalk、aws Cloudformation、aws Opsworks、amazon Virtual Private Cloud（amazon Vpc）和aws Identity And Access Management（iam）确定适当的技术和方法来编码和实现云解决方案。

**包含如下内容**
```
  * 配置一个Amazon Machine Image（AMI）
  * 配置服务以满足云上得合规性需求
  * 在AWS全球基础设施上发布实例

```

## 第三点 数据安全

### 认识到关键的灾难恢复技术及其实现
**包含如下内容**
```
  * 灾难恢复
  * Amazon EB
```


## 简介
在本章中，你将会学习Amazon Elastic Compute Cloud（Amazon EC2）和Amazon Elastic Block Store（Amazon EBS）如何提供基本的计算元素和块等级的存储，用以运行你在AWS上的workloads。对于考试来说，主要聚焦你需要理解的关键话题，包括如下内容：

* 实例类型和amazon机器映像（amis）如何定义在云上启动的实例的功能
* 如何安全地访问云上运行的实例
* 如何使用称为安全组的虚拟防火墙保护实例
* 如何让您的实例为无人参与启动配置自己
* 如何在云上监视和管理实例
* 如何改变现有实例的能力，支付选项可用于可负担性和灵活性的最佳组合
* 租赁选项和放置组如何提供选项以优化合规性和性能
* 实例存储与Amazon EBS卷有何不同以及它们何时有效
* 通过Amazon EBS提供哪些类型的卷
* 如何在amazon ebs上保护您的数据

## Amazon Elastic Compute Cloud(Amazon EC2)
Amazon EC2是AWS一个主要的web服务，在云上提供弹性调整计算的能力。

### 计算基础
* 计算是指完成工作量所需的计算能力。如果你的工作量很小，比如一个网站很少有访客，那么你的计算需求就很小。一个很大的工作量，比如针对一个常见的癌症目标筛选一千万种化合物，可能需要大量计算。您需要的计算量可能会随着时间的推移而急剧变化

* Amazon EC2允许您通过启动名为Instances的虚拟服务器来获取计算。当您启动一个实例时，您可以随心所欲地使用该计算，就像使用本地服务器一样。因为您要为实例的计算能力付费，当实例运行时，您将按小时收费。当您停止实例时，将不再收费。

* 在AWS上启动实例有两个关键概念：（1）专用于实例的虚拟硬件数量和（2）加载在实例上的软件，这两个维度的新实例分别由实例类型和AMI控制。

#### 实例类型
* 实例类型定义了支持amazon ec2实例的虚拟硬件。有几十种可用的实例类型，在以下维度中有所不同：
```
 * 虚拟CPUs（vCPUs）
 * 内存
 * 存储（大小和类型）
 * 网络性能
```

* 实例类型根据这些值之间的比率分组为多个系列。例如，M4系列提供了计算、内存和网络资源的平衡，对于许多应用程序来说，这是一个很好的选择。在每个系列中，都有几个在大小上呈线性放大的选择。图3.1显示了M4系列中的四个实例大小。请注意，vCPU与内存的比率随大小呈线性放大而保持不变。每个大小的每小时价格也呈线性放大。例如，一个m4.xlarge实例的成本是m4.large实例的两倍。
|---|---|---|
|类型|vCPUs|内存|
m4.large|2|8|
m4.xlarge|4|16|
m4.2xlarge|8|32|
m4.4xlarge|16|64|

图3.1 m4家族的实例内存和vCPUs 

备注：
```
 原文档为图，此处转换为表格。但仍叫做：图3.1
```

* 不同的实例类型族会调整比率以适应不同类型的工作负载，但它们都会在族中显示这种线性放大行为。表3.1列出了一些可用的族

**表3.1：实例类型族示例**
* 家族
|---|---|
|c4|计算型-针对需要大量处理的工作负载|
|r3|内存型-内存密集型工作负载|
|i2|存储型-需要大量快速SSD存储的工作负载|
|g2|基于GPU实例-用于图形和通用GPU计算工作负载|

* 为了响应客户需求并利用新的处理器技术，aws偶尔会引入新的实例系列。请查看aws网站上的当前列表。选择实例类型时要考虑的另一个变量是网络性能。对于大多数实例类型，aws发布了网络性能的相对度量：低、中或高。某些实例类型指定10 gbps的网络性能。随着实例类型的增长，族内的网络性能将提高。

* 对于需要更高网络性能的工作负载，许多实例类型支持增强的网络。增强的网络通过启用称为单根I/O虚拟化（SR-IOV）的功能减少了虚拟化对网络性能的影响。这会导致每秒包数（PPS）更多，延迟更低，在编写本文时，有一些实例类型支持C3、C4、D2、I2、M4中的增强型网络，和r3系列（请参阅aws文档以获取当前列表）。在实例上启用增强的网络包括确保安装了正确的驱动程序并修改实例属性。增强的网络仅适用于在amazon虚拟私有云（amazon vpc）中启动的实例，这在第4章中讨论过，“亚马逊虚拟私有云（Amazon VPC）。”

#### Amazon Machine Images（AMIs）
Amazon Machine Image（AMI）定义了实例启动是要在实例上运行的的初始化软件。AMI定义了实例启动时软件状态的各个方面，包括：
```
 * 操作系统以及其配置
 * 任何不定的初始化状态
 * 应用或者系统软件
```

* 所有的AMIs都是基于X86 OSs，无论是Linux还是Windows。
* AMIs有四个源：
```
  * 通过AWS发布
    AWS发布的AMIs有许多不同版本的操作系统，包括linux和windows；
    其中包括linux的多个发行版（包括ubuntu、red hat和Amazon自己的发行版）以及windows 2008和windows 2012。
    基于其中一个AMIs启动实例将导致默认的os设置，类似于从标准OS ISO映像安装OS。
  * AWS集市
    AWS marketplace是一个在线商店，它帮助客户查找、购买并立即开始使用运行在amazon ec2上的软件和服务。许多aws合作伙伴已经在aws marketplace上提供了他们的软件。这提供了两个好处：客户不需要安装软件，许可协议也适用于云计算，从aws marketplace ami启动的实例会产生实例类型的标准小时成本加上额外软件的每小时额外费用（一些开源aws marketplace包没有额外的软件费用）。
  * 由现有实例生成
    AMI可以从现有的Amazon EC2实例创建。
    这是AMIs的一个非常常见的来源。
    客户从发布的AMI启动一个实例，然后该实例被配置为满足所有客户的更新、管理、安全的企业标准，等等。
    然后从配置的实例生成一个AMI，并用于生成该OS的所有实例，这样，所有新实例都遵循公司标准，单个项目更难启动不一致的实例
  * 上传虚拟服务器
    使用aws vm导入/导出服务，客户可以从各种虚拟化格式创建映像，
    包括raw、vhd、vmdk和ova。
    支持的操作系统（Linux和Windows）的当前列表可以在AWS文档中找到。
    客户有责任遵守其操作系统供应商的许可条款。
```

### 安全地使用实例
* 一旦启动，实例就可以通过Internet进行管理。AWS有许多服务和特性来确保这种管理可以简单而安全地完成

#### 寻址实例
有几种方法可以在创建实例时通过Web寻址 
* 公共域名系统（DNS）名称
 当你启动一个实例时，aws创建可用于访问实例的dns名称。此dns名称是自动生成的，客户无法指定。可以在aws管理控制台的"描述"选项卡中或通过命令行界面（cli）或应用程序编程界面（api）找到此名称。此dns名称仅在实例正在运行，无法转移到其他实例

* 公共IP
 已启动的实例也可能分配了公用IP地址。此IP地址是从AWS保留的地址分配的，无法指定。此IP地址在Internet上是唯一的，仅在实例运行时持续存在，并且无法传输到其他实例。

* 弹性IP
 弹性IP地址是Internet上唯一的地址，您可以独立保留并与Amazon EC2实例关联。与公共IP类似，有一些关键的区别。这个IP地址会一直存在，直到客户释放它，并且不会绑定到单个实例的生存期或状态。因为在实例出现故障时，可以将它转移到替换实例，它是一个公共地址，可以在外部共享，而无需将客户端耦合到特定实例。

* 备注
```
 私有ip地址和弹性网络接口（enis）是amazon vpc上下文中可用的附加实例寻址方法，这些将在第4章中讨论。 
```

































